{"version":3,"file":"make-ref.js","sourceRoot":"","sources":["../../../src/components/utils/make-ref.ts"],"names":[],"mappings":"AAgBA,MAAM,UAAU,OAAO,CACrB,sBAA6C;IAE7C,IAAI,OAAO,GAA2B,SAAS,CAAC;IAChD,IAAI,cAAc,GAAG,IAAI,OAAO,CAAI,CAAC,GAAG,EAAE,EAAE,CAAC,CAAC,OAAO,GAAG,GAAG,CAAC,CAAC,CAAC;IAC9D,IAAI,OAAO,GAAkB,SAAS,CAAC;IAEvC,MAAM,cAAc,GAAG,CAAC,GAAkB,EAAE,EAAE;QAC5C,IAAI,GAAG,KAAK,SAAS,EAAE,CAAC;YACtB,OAAO;QACT,CAAC;QACD,OAAO,GAAI,cAA6B,CAAC,OAAO,GAAG,GAAG,CAAC;QACvD,sBAAsB,aAAtB,sBAAsB,uBAAtB,sBAAsB,CAAG,GAAG,CAAC,CAAC;QAC9B,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAG,GAAG,CAAC,CAAC;IACjB,CAAC,CAAC;IAEF,cAAc,CAAC,OAAO,GAAG,OAAmB,CAAC;IAE7C,cAAc,CAAC,cAAc,GAAG,KAAK,IAAI,EAAE;QACzC,MAAM,cAAc,CAAC;QACrB,OAAO,OAAO,CAAC;IACjB,CAAC,CAAC;IAEF,OAAO,cAA4B,CAAC;AACtC,CAAC","sourcesContent":["/*\n * SPDX-FileCopyrightText: 2024 Siemens AG\n *\n * SPDX-License-Identifier: MIT\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\nexport type MakeRef<T> = {\n  (ref: T | undefined | null): void;\n  current: T | null;\n  waitForCurrent(): Promise<T>;\n};\n\ntype Resolve<T> = (value: T) => void;\n\nexport function makeRef<T>(\n  currentChangedCallback?: (element: T) => void\n): MakeRef<T> {\n  let resolve: Resolve<T> | undefined = undefined;\n  let currentPromise = new Promise<T>((res) => (resolve = res));\n  let current: T | undefined = undefined;\n\n  const setRefFunction = (ref: T | undefined) => {\n    if (ref === undefined) {\n      return;\n    }\n    current = (setRefFunction as MakeRef<T>).current = ref;\n    currentChangedCallback?.(ref);\n    resolve?.(ref);\n  };\n\n  setRefFunction.current = current as T | null;\n\n  setRefFunction.waitForCurrent = async () => {\n    await currentPromise;\n    return current;\n  };\n\n  return setRefFunction as MakeRef<T>;\n}\n"]}