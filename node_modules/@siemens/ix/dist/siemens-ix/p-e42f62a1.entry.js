import{r as t,c as i,h as s,H as e,g as r}from"./p-CtoreFVF.js";import{f as o,i as h,s as n,o as a,a as d,c as l}from"./p-CAqtPJ4-.js";import{A as c}from"./p-CUWFODSd.js";import{d as u,h as f}from"./p-D3K9vmFp.js";import{f as b}from"./p-CFRrPFxi.js";import{a as m}from"./p-CKoABG1h.js";const v=":host{background-color:var(--theme-color-2);border-radius:var(--theme-default-border-radius);min-width:0px;z-index:var(--theme-z-index-dropdown);box-shadow:var(--theme-shadow-4);padding:0.25rem 0px}:host *,:host *::after,:host *::before{box-sizing:border-box}:host ::-webkit-scrollbar-button{display:none}@-moz-document url-prefix(){:host *{scrollbar-color:var(--theme-scrollbar-thumb--background) var(--theme-scrollbar-track--background);scrollbar-width:thin}}:host{}:host ::-webkit-scrollbar{width:0.5rem;height:0.5rem}:host{}:host ::-webkit-scrollbar-track{border-radius:5px;background:var(--theme-scrollbar-track--background)}:host ::-webkit-scrollbar-track:hover{background:var(--theme-scrollbar-track--background--hover)}:host{}:host ::-webkit-scrollbar-thumb{border-radius:5px;background:var(--theme-scrollbar-thumb--background)}:host{}:host ::-webkit-scrollbar-thumb:hover{background:var(--theme-scrollbar-thumb--background--hover)}:host ::-webkit-scrollbar-corner{display:none}:host .dropdown-header{display:flex;align-items:center;height:2.5rem;color:var(--theme-menu-header--color);padding:0 1rem}:host(.overflow){max-height:calc(50vh - 3rem);overflow-y:auto}:host(:not(.show)){display:none}";let w=0;const p=class{constructor(s){t(this,s);this.showChanged=i(this,"showChanged",7);this.suppressAutomaticPlacement=false;this.show=false;this.closeBehavior="both";this.placement="bottom-start";this.positioningStrategy="fixed";this.discoverAllSubmenus=false;this.ignoreRelatedSubmenu=false;this.suppressOverflowBehavior=false;this.localUId=`dropdown-${w++}`;this.assignedSubmenu=[];this.itemObserver=new MutationObserver((()=>{if(this.arrowFocusController){this.arrowFocusController.items=this.dropdownItems}}))}connectedCallback(){u.connected(this);if(this.trigger!=undefined){this.registerListener(this.trigger)}}cacheSubmenuId(t){t.stopImmediatePropagation();t.preventDefault();const{detail:i}=t;if(this.assignedSubmenu.indexOf(i)===-1){this.assignedSubmenu.push(i)}}disconnectedCallback(){var t;u.dismiss(this);u.disconnected(this);if(this.arrowFocusController){(t=this.arrowFocusController)===null||t===void 0?void 0:t.disconnect();this.arrowFocusController=undefined}if(this.itemObserver){this.itemObserver.disconnect();this.itemObserver=undefined}if(this.disposeClickListener){this.disposeClickListener();this.disposeClickListener=undefined}if(this.disposeKeyListener){this.disposeKeyListener();this.disposeKeyListener=undefined}if(this.autoUpdateCleanup){this.autoUpdateCleanup();this.autoUpdateCleanup=undefined}}getAssignedSubmenuIds(){return this.assignedSubmenu}isPresent(){return this.show}present(){this.show=true}dismiss(){this.show=false}getId(){return this.localUId}willDismiss(){const{defaultPrevented:t}=this.showChanged.emit(false);return!t}willPresent(){const{defaultPrevented:t}=this.showChanged.emit(true);return!t}get dropdownItems(){return Array.from(this.hostElement.querySelectorAll("ix-dropdown-item"))}get slotElement(){return this.hostElement.shadowRoot.querySelector("slot")}addEventListenersFor(){var t,i,s;(t=this.disposeClickListener)===null||t===void 0?void 0:t.call(this);(i=this.disposeKeyListener)===null||i===void 0?void 0:i.call(this);const e=()=>{if(!this.isPresent()){u.present(this)}else{u.dismiss(this)}u.dismissOthers(this.getId())};if(!this.triggerElement){return}this.disposeClickListener=m(this.triggerElement,"click",(t=>{if(!t.defaultPrevented){e()}}));(s=this.triggerElement)===null||s===void 0?void 0:s.setAttribute("data-ix-dropdown-trigger",this.localUId)}async discoverSubmenu(){var t;(t=this.triggerElement)===null||t===void 0?void 0:t.dispatchEvent(new CustomEvent("ix-assign-sub-menu",{bubbles:true,composed:true,cancelable:true,detail:this.localUId}))}registerKeyListener(){if(!this.triggerElement){return}this.disposeKeyListener=m(this.triggerElement,"keydown",(t=>{if(t.key!=="ArrowDown"){return}if(document.activeElement!==this.triggerElement){return}u.present(this);setTimeout((()=>{this.focusDropdownItem(0)}))}))}async registerListener(t){this.triggerElement=await this.resolveElement(t);if(this.triggerElement){this.addEventListenersFor();this.discoverSubmenu()}}async resolveElement(t){const i=await b(t);return this.checkForSubmenuAnchor(i)}async checkForSubmenuAnchor(t){if(!t){return undefined}if(f(t)){const i=await t.getDropdownItemElement();i.isSubMenu=true;this.hostElement.style.zIndex=`var(--theme-z-index-dropdown)`}if(t.tagName==="IX-DROPDOWN-ITEM"){t.isSubMenu=true;this.hostElement.style.zIndex=`var(--theme-z-index-dropdown)`}return t}async resolveAnchorElement(){if(this.anchor){this.anchorElement=await this.resolveElement(this.anchor)}else if(this.trigger){this.anchorElement=await this.resolveElement(this.trigger)}}async changedShow(t){var i,s,e,r;if(t){await this.resolveAnchorElement();if(this.anchorElement){this.applyDropdownPosition()}this.arrowFocusController=new c(this.dropdownItems,this.hostElement,(t=>this.focusDropdownItem(t)));(i=this.itemObserver)===null||i===void 0?void 0:i.observe(this.hostElement,{childList:true,subtree:true});this.registerKeyListener()}else{this.destroyAutoUpdate();(s=this.arrowFocusController)===null||s===void 0?void 0:s.disconnect();(e=this.itemObserver)===null||e===void 0?void 0:e.disconnect();(r=this.disposeKeyListener)===null||r===void 0?void 0:r.call(this)}}changedTrigger(t){this.registerListener(t)}destroyAutoUpdate(){if(this.autoUpdateCleanup){this.autoUpdateCleanup();this.autoUpdateCleanup=undefined}}isAnchorSubmenu(){var t;if(!f(this.anchorElement)){return!!((t=this.anchorElement)===null||t===void 0?void 0:t.closest("ix-dropdown-item"))}return true}async applyDropdownPosition(){var t,i;if(!this.show){return}if(!this.anchorElement){return}const s=this.isAnchorSubmenu();let e={strategy:this.positioningStrategy,middleware:[]};if(!this.suppressAutomaticPlacement){(t=e.middleware)===null||t===void 0?void 0:t.push(o({fallbackStrategy:"initialPlacement"}))}e.placement=s?"right-start":this.placement;e.middleware=[...((i=e.middleware)===null||i===void 0?void 0:i.filter(Boolean))||[],h(),n()];if(this.offset){e.middleware.push(a(this.offset))}this.destroyAutoUpdate();if(!this.anchorElement){return}this.autoUpdateCleanup=d(this.anchorElement,this.hostElement,(async()=>{if(this.anchorElement){const t=await l(this.anchorElement,this.hostElement,e);Object.assign(this.hostElement.style,{top:"0",left:"0",transform:`translate(${Math.round(t.x)}px,${Math.round(t.y)}px)`})}if(this.overwriteDropdownStyle){const t=await this.overwriteDropdownStyle({dropdownRef:this.hostElement,triggerRef:this.triggerElement});Object.assign(this.hostElement.style,t)}}),{ancestorResize:true,ancestorScroll:true,elementResize:true})}focusDropdownItem(t){requestAnimationFrame((()=>{var i,s;const e=(s=(i=this.dropdownItems[t])===null||i===void 0?void 0:i.shadowRoot)===null||s===void 0?void 0:s.querySelector("button");if(e){e.focus()}}))}async componentDidLoad(){if(!this.trigger){return}this.changedTrigger(this.trigger)}async componentDidRender(){await this.applyDropdownPosition();await this.resolveAnchorElement()}isTriggerElement(t){const i=!!t.hasAttribute("data-ix-dropdown-trigger");return i}onDropdownClick(t){const i=u.pathIncludesTrigger(t.composedPath());if(i){if(i!==this.triggerElement){t.preventDefault()}if(this.isTriggerElement(i)){if(this.closeBehavior==="outside"){t.preventDefault()}return}}if(!t.defaultPrevented&&(this.closeBehavior==="inside"||this.closeBehavior==="both")){u.dismissAll([this.getId()],this.ignoreRelatedSubmenu);return}u.dismissOthers(this.getId())}async updatePosition(){this.applyDropdownPosition()}render(){return s(e,{key:"04a27e5950bf94cc355c91e0339f9450d46ff103","data-ix-dropdown":this.localUId,class:{"dropdown-menu":true,show:this.show,overflow:!this.suppressOverflowBehavior},style:{margin:"0",minWidth:"0px",position:this.positioningStrategy},role:"list",onClick:t=>this.onDropdownClick(t)},s("div",{key:"a5a82065838d09c0b0e8aa24887485664d0631b7",style:{display:"contents"}},this.header&&s("div",{key:"08e34e9d67769670fed4328d59d23de0d0bc1ccb",class:"dropdown-header"},this.header),this.show&&s("slot",{key:"ecf81415481bb26881fd6976b5e069ac444bb821"})))}get hostElement(){return r(this)}static get watchers(){return{show:["changedShow"],trigger:["changedTrigger"]}}};p.style=v;export{p as ix_dropdown};
//# sourceMappingURL=p-e42f62a1.entry.js.map