function t(t){return t!==null&&t.getDropdownItemElement!==undefined&&typeof t.getDropdownItemElement==="function"}class s{constructor(){this.dropdowns=new Map;this.submenuIds={};this.isWindowListenerActive=false}connected(t){if(!this.isWindowListenerActive){this.addOverlayListeners()}this.dropdowns.set(t.getId(),t);if(t.discoverAllSubmenus){this.discoverSubmenus()}}disconnected(t){const s=t.getId();this.removeFromSubmenuIds(s);this.dropdowns.delete(s)}removeFromSubmenuIds(t){this.dropdowns.forEach((s=>{const i=this.submenuIds[s.getId()];if(i){const s=i.indexOf(t);if(s>-1){i.splice(s,1)}}}));delete this.submenuIds[t]}getDropdownById(t){return this.dropdowns.get(t)}discoverSubmenus(){this.dropdowns.forEach((t=>{t.discoverSubmenu()}))}present(t){var s;if(!t.isPresent()&&((s=t.willPresent)===null||s===void 0?void 0:s.call(t))){this.submenuIds[t.getId()]=t.getAssignedSubmenuIds();t.present()}}dismissChildren(t){const s=this.submenuIds[t]||[];for(const t of s){const s=this.dropdowns.get(t);if(s){this.dismiss(s)}}}dismiss(t){var s;if(t.isPresent()&&((s=t.willDismiss)===null||s===void 0?void 0:s.call(t))){this.dismissChildren(t.getId());t.dismiss();delete this.submenuIds[t.getId()]}}dismissAll(t=[],s=false){this.dropdowns.forEach((i=>{const e=i.closeBehavior==="inside"||i.closeBehavior===false;const n=t.includes(i.getId());const o=this.buildComposedPath(i.getId(),new Set);if(t.length>0&&s){let s=false;t.forEach((t=>{if(o.has(t)){s=true;return}}));if(!s){return}}if(!n&&e){return}this.dismiss(i)}))}dismissOthers(t){let s=this.buildComposedPath(t,new Set);s.add(t);this.dropdowns.forEach((t=>{if(t.closeBehavior!=="inside"&&t.closeBehavior!==false&&!s.has(t.getId())){this.dismiss(t)}}))}pathIncludesTrigger(t){for(let s of t){if(s instanceof HTMLElement){if(s.hasAttribute("data-ix-dropdown-trigger")){return s}}}return}pathIncludesDropdown(t){return!!t.find((t=>t.tagName==="IX-DROPDOWN"))}buildComposedPath(t,s){if(this.submenuIds[t]){s.add(t)}for(const i of Object.keys(this.submenuIds)){if(this.submenuIds[i].includes(t)){this.buildComposedPath(i,s).forEach((t=>s.add(t)))}}return s}addOverlayListeners(){this.isWindowListenerActive=true;window.addEventListener("click",(t=>{const s=this.pathIncludesTrigger(t.composedPath());const i=this.pathIncludesDropdown(t.composedPath());if(!s&&!i){this.dismissAll()}}));window.addEventListener("keydown",(t=>{if(t.key==="Escape"){this.dismissAll([...this.dropdowns.keys()])}}))}}const i=new s;export{i as d,t as h};
//# sourceMappingURL=p-D3K9vmFp.js.map