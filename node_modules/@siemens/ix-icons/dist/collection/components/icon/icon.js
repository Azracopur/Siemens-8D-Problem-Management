/*
 * SPDX-FileCopyrightText: 2023 Siemens AG
 *
 * SPDX-License-Identifier: MIT
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
import { h, Host, Build } from "@stencil/core";
import { resolveIcon } from "./resolveIcon";
import { errorSymbol, parseSVGDataContent } from "./parser";
export class Icon {
    hostElement;
    /**
     * Size of the icon
     */
    size = '24';
    /**
     * Color of the icon
     */
    color;
    /**
     * Use one of our defined icon names e.g. `copy`
     *
     * https://ix.siemens.io/docs/icon-library/icons
     *
     * or the import variant
     *
     * ```
     * import { rocket } from '@siemens/ix-icons/icons';
     *
     * <ix-icon name={rocket}></ix-icon>
     * ```
     */
    name;
    /**
     * Only fetch and parse svg data when icon is visible
     */
    lazyLoading = false;
    svgContent;
    isVisible = false;
    componentWillLoad() {
        this.waitForRendering(() => {
            this.isVisible = true;
            this.loadIconContent();
        });
    }
    async loadIconContent() {
        const content = await resolveIcon(this.hostElement, this.name);
        if (!content) {
            this.svgContent = parseSVGDataContent(errorSymbol);
            return;
        }
        this.svgContent = content;
    }
    waitForRendering(onRender) {
        if (Build.isBrowser && this.lazyLoading && typeof window !== 'undefined' && window.IntersectionObserver) {
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        onRender();
                        observer.disconnect();
                    }
                });
            }, {
                rootMargin: '25px',
            });
            observer.observe(this.hostElement);
        }
        else {
            onRender();
        }
    }
    render() {
        const style = {};
        if (this.color) {
            style['color'] = `var(--theme-${this.color})`;
        }
        return (h(Host, { key: '83462a7d7da16587faaa0600b4c13ec8ad106a77', role: "img", style: style, class: {
                ['size-12']: this.size === '12',
                ['size-16']: this.size === '16',
                ['size-24']: this.size === '24',
                ['size-32']: this.size === '32',
            } }, h("div", { key: '570efdb71fcdd0c61b7c854c6ab3662508aae804', class: 'svg-container', innerHTML: this.svgContent, "aria-hidden": "true" })));
    }
    static get is() { return "ix-icon"; }
    static get encapsulation() { return "shadow"; }
    static get originalStyleUrls() {
        return {
            "$": ["icon.scss"]
        };
    }
    static get styleUrls() {
        return {
            "$": ["icon.css"]
        };
    }
    static get assetsDirs() { return ["svg"]; }
    static get properties() {
        return {
            "size": {
                "type": "string",
                "mutable": false,
                "complexType": {
                    "original": "'12' | '16' | '24' | '32'",
                    "resolved": "\"12\" | \"16\" | \"24\" | \"32\"",
                    "references": {}
                },
                "required": false,
                "optional": false,
                "docs": {
                    "tags": [],
                    "text": "Size of the icon"
                },
                "getter": false,
                "setter": false,
                "reflect": false,
                "attribute": "size",
                "defaultValue": "'24'"
            },
            "color": {
                "type": "string",
                "mutable": false,
                "complexType": {
                    "original": "string",
                    "resolved": "string | undefined",
                    "references": {}
                },
                "required": false,
                "optional": true,
                "docs": {
                    "tags": [],
                    "text": "Color of the icon"
                },
                "getter": false,
                "setter": false,
                "reflect": false,
                "attribute": "color"
            },
            "name": {
                "type": "string",
                "mutable": false,
                "complexType": {
                    "original": "string",
                    "resolved": "string | undefined",
                    "references": {}
                },
                "required": false,
                "optional": true,
                "docs": {
                    "tags": [],
                    "text": "Use one of our defined icon names e.g. `copy`\n\nhttps://ix.siemens.io/docs/icon-library/icons\n\nor the import variant\n\n```\nimport { rocket } from '@siemens/ix-icons/icons';\n\n<ix-icon name={rocket}></ix-icon>\n```"
                },
                "getter": false,
                "setter": false,
                "reflect": false,
                "attribute": "name"
            },
            "lazyLoading": {
                "type": "boolean",
                "mutable": false,
                "complexType": {
                    "original": "boolean",
                    "resolved": "boolean",
                    "references": {}
                },
                "required": false,
                "optional": false,
                "docs": {
                    "tags": [],
                    "text": "Only fetch and parse svg data when icon is visible"
                },
                "getter": false,
                "setter": false,
                "reflect": false,
                "attribute": "lazy-loading",
                "defaultValue": "false"
            }
        };
    }
    static get states() {
        return {
            "svgContent": {},
            "isVisible": {}
        };
    }
    static get elementRef() { return "hostElement"; }
    static get watchers() {
        return [{
                "propName": "name",
                "methodName": "loadIconContent"
            }];
    }
}
//# sourceMappingURL=icon.js.map
